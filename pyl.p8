pico-8 cartridge // http://www.pico-8.com
version 41
__lua__
--setup
function _init()
    deck=shuffle(init_deck())
    tableau={}
    resources={
        coins=0,
        heat=0,
        points=0
    }
    cls(0)
end

function _update()

end

function _draw()
    draw_card(cards.jack, 20,20)
end
-->8
--game
function update_resources(tbl)
    for k,v in pairs(tbl) do
        resources[k] += v
    end
end
-->8
--card
function draw_card(card,x,y)
    local a = 30
    local b = a - 1
    local c = 40
    local d = c - 1
    rect(x,y+1,x+a,y+d,7)
    rect(x+1,y,x+b,y+c,7)
    
    circ(x+1,y+1,4)
    circ(x+2,y+1,4)
    circ(x+1,y+2,4)
    circ(x+2,y+2,4)

    spr(2,x-2,y-2)
end

function trigger(card)
    for suit in all(card.external_triggers) do
        for i,c in pairs(tableau) do
            if i != #tableau and c.trigger == suit then
                update_resources(c.triggered_resources)
            end
        end
    end
end
-->8
--deck
function init_deck()
    return {1,2,3}
end

function shuffle(deck)
    local result = {}
    while #deck > 0 do
        local i = flr(rnd(#deck)) + 1
        add(result, deck[i])
        deli(deck, i)
    end
    return result
end
-->8
--utils
-->8
--cards
cards = {
    jack={
        name="jack",
        cost="2",
        base_resources={
            coins=2
        },
        triggered_resources={
            heat=1
        },
        trigger="blue",
        external_triggers={"red", "green"}
    },
    queen={
        name="queen",
        cost="4",
        base_resources={
            coins=1,
            points=1,
            heat=1
        },
        triggered_resources={
            points=1
        },
        trigger="red",
        external_triggers={"blue"}
    },
    king={
        name="king",
        cost="5",
        base_resources={
            coins=3
        },
        triggered_resources={
            heat=3
        },
        trigger="black",
        external_triggers={"red", "green", "blue"}
    },
    ace={
        name="ace",
        cost="4",
        base_resources={
            heat=-3
        },
        triggered_resources={
            points=1,
            heat=1
        },
        trigger="blue",
        external_triggers={"blue"}
    },
}
__gfx__
0000000000aaaa000088880000cccc0000bbbb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000aaa77a00888ee800ccc77c00bbb77b00000777000000000000000000000000000000000000000000000000000000000000000000000000000000000
007007009aaaa77a28888ee81cccc77c3bbbb77b0007888700000000000000000000000000000000000000000000000000000000000000000000000000000000
000770009aaaaa7a288888e81ccccc7c3bbbbb7b00788ee870000000000000000000000000000000000000000000000000000000000000000000000000000000
000770009aaaaaaa288888881ccccccc3bbbbbbb072888ee87888888888888800000000000000000000000000000000000000000000000000000000000000000
0070070099aaaaaa2288888811cccccc33bbbbbb0728888e87888888888888880000000000000000000000000000000000000000000000000000000000000000
00000000099aaaa002288880011cccc0033bbbb00722888887000000000008880000000000000000000000000000000000000000000000000000000000000000
00000000009999000022220000111100003333000072288870000000000000880000000000000000000000000000000000000000000000000000000000000000
00000000000700000007000000000000000000000007222700000000000000880000000000000000000000000000000000000000000000000000000000000000
00000000007870000079700000000000000000000000777000000000000000880000000000000000000000000000000000000000000000000000000000000000
00000000078887000799970000000000000000000000880000000000000000880000000000000000000000000000000000000000000000000000000000000000
00000000788788707999997000000000000000000000880000000000000000880000000000000000000000000000000000000000000000000000000000000000
00000000787878700799970000000000000000000000880000000000000000880000000000000000000000000000000000000000000000000000000000000000
00000000078887000079700000000000000000000000880000000000000000880000000000000000000000000000000000000000000000000000000000000000
00000000788788700007000000000000000000000000880000000000000000880000000000000000000000000000000000000000000000000000000000000000
00000000787078700000000000000000000000000000880000000000000000880000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000880000000000000000880000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000880000000000000000880000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000880000000000000000880000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000880000000000000000880000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000880000000000000000880000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000880000000000000000880000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000880000000000000000880000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000880000000000000000880000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000880000000000000000880000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000888000000000000008880000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000888888888888888888880000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000088888888888888888800000000000000000000000000000000000000000000000000000000000000000
